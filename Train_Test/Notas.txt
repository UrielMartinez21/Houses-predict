self.image_features_ = nn.Sequential(
    nn.Conv2d(3, 16, kernel_size=5, stride=1, padding=2),  # Cambié stride a 1
    nn.ReLU(inplace=True),
    nn.MaxPool2d(kernel_size=2, stride=2),  # MaxPooling más conservador

    nn.Conv2d(16, 128, kernel_size=5, padding=2),
    nn.ReLU(inplace=True),
    nn.MaxPool2d(kernel_size=2, stride=2),  # MaxPooling moderado

    nn.Conv2d(128, 128, kernel_size=5, padding=2),
    nn.ReLU(inplace=True),
    nn.MaxPool2d(kernel_size=2, stride=2),

    nn.Conv2d(128, 64, kernel_size=5, padding=2),
    nn.ReLU(inplace=True),
    nn.MaxPool2d(kernel_size=2, stride=2),  # Mantiene el tamaño reducido gradualmente
)